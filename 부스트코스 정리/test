

select a.*
		,date_format(join_date,'%y-%m') as 가입년월
        ,2021 - year(birthday)+1 as 나이
        ,case when 2021 - year(birthday) + 1 < 20 then '10대 이하'
			  when 2021 - year(birthday) + 1 < 30 then '20대'
              when 2021 - year(birthday) + 1 < 40 then '30대'
              when 2021 - year(birthday) + 1 < 50 then '40대'
              when 2021 - year(birthday) + 1 < 60 then '50대 이상'
              else '60대 이상' end as 연령대
		,case when b.mem_no is not null then '구매'
				else '미구매' end as 구매여부
from customer as a
left
join(
	 select distinct mem_no
	  from sales
      )as b
      on a.mem_no = b.mem_no;
      
      
select       
